<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <title>Ton Secret Shop</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root{
      --bg0:#07060a;
      --bg1:#0b0a12;
      --text:#f1f1ff;
      --muted:#b7b5d4;
      --stroke:rgba(255,255,255,.10);
      --shadow: 0 18px 48px rgba(0,0,0,.55);
      --p1:#7c3aed;
      --p2:#22d3ee;
      --cardA: rgba(255,255,255,.06);
      --cardB: rgba(255,255,255,.03);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:
        radial-gradient(900px 520px at 50% -10%, rgba(124,58,237,.28), transparent 60%),
        radial-gradient(700px 460px at 80% 10%, rgba(34,211,238,.18), transparent 55%),
        radial-gradient(900px 600px at 30% 120%, rgba(167,139,250,.16), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      min-height:100vh;
      padding: 16px 14px 90px;
      display:flex;
      justify-content:center;
      overflow-x:hidden;
    }
    .wrap{ width:min(460px,100%); }

    /* Debug HUD */
    #dbg{
      position:fixed; left:10px; bottom:10px; right:10px;
      padding:10px 12px;
      border-radius:16px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      backdrop-filter: blur(10px);
      color: rgba(255,255,255,.92);
      font-size:12px;
      display:none;
      z-index:9999;
      white-space:pre-line;
    }

    /* Header */
    .top{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:12px; }
    .brand{ display:flex; align-items:center; gap:12px; min-width:0; flex:1; }
    .logo{
      width:46px;height:46px;border-radius:16px;
      background: rgba(255,255,255,.05);
      border:1px solid var(--stroke);
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      overflow:hidden; flex:0 0 auto; display:grid;place-items:center;
    }
    .logo img{ width:100%;height:100%; object-fit:cover; display:block; }
    .titleWrap{ min-width:0; flex:1; }
    .title{
      margin:0; font-weight:900; font-size:16px; letter-spacing:.2px;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .subRow{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-top:4px; }
    .sub{
      margin:0; font-size:12px; color:var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis; flex:1;
    }
    .hdrBtns{ display:flex; gap:8px; flex:0 0 auto; }
    .iconBtn{
      width:38px;height:38px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(241,241,255,.92);
      display:grid;place-items:center;
      cursor:pointer;
      box-shadow: 0 16px 44px rgba(0,0,0,.25);
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .iconBtn:active{ transform: scale(.98); }
    .iconBtn svg{ width:18px;height:18px; opacity:.95; }

    /* Tabs */
    .tabs{
      display:flex; gap:8px; padding:8px; border-radius:18px;
      background: rgba(255,255,255,.05);
      border:1px solid var(--stroke);
      box-shadow: 0 12px 34px rgba(0,0,0,.35);
      margin-bottom:12px;
      position:sticky; top:10px;
      backdrop-filter: blur(10px);
      z-index:2;
    }
    .tab{
      flex:1; border:none; background: transparent;
      color: rgba(241,241,255,.78);
      font-weight:900; padding:12px 10px;
      border-radius:16px; cursor:pointer; font-size:13px;
      display:flex; align-items:center; justify-content:center; gap:8px;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .tab .dot{
      width:10px;height:10px;border-radius:3px;
      background: rgba(255,255,255,.00);
      border:1px solid rgba(255,255,255,.00);
      flex:0 0 auto;
    }
    .tab.active{
      color: var(--text);
      background: linear-gradient(90deg, rgba(124,58,237,.35), rgba(34,211,238,.18));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 16px 44px rgba(124,58,237,.16);
    }
    .tab.active .dot{
      background: rgba(255,255,255,.45);
      border:1px solid rgba(255,255,255,.22);
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
    }

    /* Cards */
    .card{
      border-radius:20px;
      background: linear-gradient(180deg, var(--cardA), var(--cardB));
      border:1px solid var(--stroke);
      box-shadow: var(--shadow);
      padding: 14px;
      backdrop-filter: blur(10px);
      margin-bottom:12px;
    }
    .note{ margin-top:0; font-size:12px; color: rgba(241,241,255,.78); line-height:1.4; }
    .foot{ margin-top:6px; font-size:11px; color: rgba(241,241,255,.55); }
    .grid{ display:grid; grid-template-columns: 1fr; gap:12px; }

    .service{ display:flex; gap:12px; align-items:flex-start; }
    .icon{
      width:44px;height:44px;border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(180deg, rgba(124,58,237,.22), rgba(34,211,238,.10));
      display:grid; place-items:center;
      flex:0 0 auto;
      box-shadow: 0 16px 44px rgba(0,0,0,.35);
    }
    .icon svg{ width:22px;height:22px; opacity:.95; }
    .service h3{ margin:0; font-size:14px; font-weight:900; letter-spacing:.2px; }
    .service p{ margin:6px 0 0; color: var(--muted); font-size:12px; line-height:1.35; }

    .thumb{
      margin-top:10px;
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius:16px;
      border:1px dashed rgba(255,255,255,.18);
      background:
        radial-gradient(500px 220px at 30% 0%, rgba(124,58,237,.18), transparent 65%),
        linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.02));
      display:grid;
      place-items:center;
      color: rgba(241,241,255,.58);
      font-size:12px;
      overflow:hidden;
      position:relative;
    }
    .thumb img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
      border-radius:16px;
    }
    .thumb .ph{
      position:absolute; inset:0;
      display:none; place-items:center;
      padding:10px; text-align:center;
      color: rgba(241,241,255,.62);
      background: rgba(0,0,0,.10);
      backdrop-filter: blur(2px);
    }

    .priceTitle{ margin-top:10px; font-size:12px; color: rgba(241,241,255,.85); font-weight:900; }
    .options{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .opt{
      border:none; cursor:pointer; padding:8px 10px; border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color: rgba(241,241,255,.85);
      font-weight:900; font-size:12px;
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .opt.active{
      background: linear-gradient(90deg, rgba(124,58,237,.38), rgba(34,211,238,.20));
      border:1px solid rgba(255,255,255,.16);
      color:#fff;
      box-shadow: 0 16px 44px rgba(124,58,237,.14);
    }

    .row{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; align-items:center; }
    .btn{
      border:none; cursor:pointer;
      font-weight:900; font-size:13px;
      padding:12px 14px;
      border-radius:16px;
      color:#05050a;
      background: linear-gradient(90deg, rgba(124,58,237,1), rgba(34,211,238,1));
      box-shadow: 0 16px 44px rgba(124,58,237,.20);
      flex: 1 1 160px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn.secondary{
      background: rgba(255,255,255,.06);
      color: var(--text);
      border:1px solid var(--stroke);
      box-shadow:none;
    }

    .qtyWrap{
      display:flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:16px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      flex:0 0 auto;
    }
    .qtyBtn{
      width:34px;height:34px;border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: rgba(241,241,255,.92);
      cursor:pointer;
      font-weight:900;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .qtyVal{ min-width:22px; text-align:center; font-weight:900; color: rgba(241,241,255,.92); font-size:13px; }

    .screen{ display:none; }
    .screen.active{ display:block; }

    /* Cart */
    .cartHead{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
    .cartHead h3{ margin:0; font-size:13px; font-weight:900; letter-spacing:.2px; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      font-size:12px; color: rgba(241,241,255,.80); font-weight:900;
      user-select:none;
    }
    .cartList{ display:flex; flex-direction:column; gap:8px; margin-top:10px; }
    .cartItem{
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
      padding:10px; border-radius:16px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
    }
    .cartItem b{ display:block; font-size:12px; }
    .cartItem span{ display:block; font-size:11px; color: rgba(241,241,255,.70); margin-top:2px; }
    .miniBtn{
      border:none; cursor:pointer;
      border-radius:12px; padding:8px 10px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color: rgba(241,241,255,.90);
      font-weight:900; font-size:12px;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      flex:0 0 auto;
    }
    .miniBtn.danger{ color:#fff; background: rgba(239,68,68,.18); border-color: rgba(239,68,68,.25); }
    .total{
      display:flex; justify-content:space-between; align-items:center;
      margin-top:10px; padding-top:10px;
      border-top:1px solid rgba(255,255,255,.10);
      font-weight:900; color: rgba(241,241,255,.92); font-size:13px;
    }
    .mutedSmall{ font-size:11px; color: rgba(241,241,255,.55); margin-top:6px; }

    /* Portfolio */
    .portfolioGrid{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .work{
      border-radius:16px; border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.04);
      aspect-ratio: 1 / 1;
      display:grid; place-items:center;
      color: rgba(241,241,255,.65);
      font-size:12px;
      overflow:hidden;
      cursor:pointer;
      user-select:none;
      position:relative;
      -webkit-tap-highlight-color: transparent;
    }
    .work:active{ transform: scale(0.99); }
    .work img{ width:100%;height:100%;object-fit:cover;display:block; }
    .work .label{
      position:absolute; left:10px; bottom:10px;
      padding:6px 10px; border-radius:999px;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.12);
      color: rgba(241,241,255,.92);
      font-weight:900; font-size:11px;
      backdrop-filter: blur(8px);
    }
    .work .ph{
      position:absolute; inset:0;
      display:none; place-items:center;
      text-align:center; padding:10px;
      color: rgba(241,241,255,.62);
      background: rgba(0,0,0,.10);
      backdrop-filter: blur(2px);
    }

    /* Liquid glass backdrops (IMPORTANT: no click stealing when hidden) */
    .backdrop{
      position:fixed; inset:0;
      background: rgba(0,0,0,.50);
      display:flex;
      align-items:flex-end;
      justify-content:center;
      padding:14px;
      z-index:50;

      opacity:0;
      transform: translateY(8px);
      transition: opacity .28s ease, transform .28s ease;

      visibility:hidden;
      pointer-events:none;
    }
    .backdrop.show{
      opacity:1;
      transform: translateY(0);
      visibility:visible;
      pointer-events:auto;
    }
    .wrap.modalOpen{
      transition: transform .28s ease, filter .28s ease;
      transform: scale(.985);
      filter: blur(1.2px) saturate(1.05);
    }
    .modal{
      width:min(460px,100%);
      border-radius:22px;
      background: linear-gradient(180deg, rgba(255,255,255,.12), rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow);
      padding: 14px;
      backdrop-filter: blur(14px);
      transform: translateY(16px) scale(.985);
      opacity:0;
      transition: transform .28s ease, opacity .28s ease;
    }
    .backdrop.show .modal{ transform: translateY(0) scale(1); opacity:1; }
    .modalHead{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
    .modalHead h2{ margin:0; font-size:14px; font-weight:900; }
    .x{ border:none; background:transparent; color:#fff; font-size:22px; cursor:pointer; opacity:.85; }
    .modal p{ margin:10px 0 0; color:rgba(241,241,255,.78); font-size:12px; line-height:1.45; }
    .modal a{ color: var(--p2); font-weight:900; text-decoration:none; }

    .mImg{
      width:100%;
      aspect-ratio: 1 / 1;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      box-shadow: 0 18px 48px rgba(0,0,0,.35);
      transform: scale(.98);
      animation: popIn .28s ease forwards;
    }
    @keyframes popIn{
      from{ transform: scale(.955); filter: blur(1px); }
      to{ transform: scale(1); filter: blur(0); }
    }
    .mImg img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
      transform: scale(1.02);
      animation: microZoom .70s ease forwards;
    }
    @keyframes microZoom{
      from{ transform: scale(1.06); filter: saturate(1.08); }
      to{ transform: scale(1.02); filter: saturate(1.00); }
    }

    /* Order inner tabs */
    .subTabs{
      display:flex; gap:8px; padding:8px; border-radius:18px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      margin-bottom:12px;
      backdrop-filter: blur(10px);
    }
    .subTab{
      flex:1; border:none; cursor:pointer;
      border-radius:16px; padding:10px 10px;
      font-weight:900;
      color: rgba(241,241,255,.78);
      background: transparent;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .subTab.active{
      color:#fff;
      background: linear-gradient(90deg, rgba(124,58,237,.34), rgba(34,211,238,.18));
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 16px 44px rgba(124,58,237,.14);
    }
    .progressWrap{
      margin-top:10px;
      height:12px;
      border-radius:999px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
    }
    .progressFill{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(124,58,237,1), rgba(34,211,238,1));
      transition: width .25s ease;
    }

    /* Inventory */
    .invGrid{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      margin-top:12px;
    }
    .slot{
      aspect-ratio: 1 / 1;
      border-radius:18px;
      background: rgba(255,255,255,.04);
      border:1px dashed rgba(255,255,255,.18);
      display:grid;
      place-items:center;
      color: rgba(241,241,255,.62);
      font-size:11px;
      text-align:center;
      padding:10px;
    }
    .bubble{
      margin-top:10px;
      padding:10px 12px;
      border-radius:16px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color: rgba(241,241,255,.78);
      font-size:12px;
      line-height:1.35;
    }

    /* Splash */
    #splash{
      position:fixed; inset:0;
      display:flex; align-items:center; justify-content:center;
      background:
        radial-gradient(900px 520px at 50% -10%, rgba(124,58,237,.33), transparent 60%),
        radial-gradient(700px 460px at 80% 10%, rgba(34,211,238,.22), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      z-index:999;
      overflow:hidden;
    }
    #starfield{ position:absolute; inset:0; pointer-events:none; opacity:.98; }
    .star{
      position:absolute; border-radius:999px;
      background: rgba(255,255,255,.98);
      box-shadow: 0 0 10px rgba(255,255,255,.55), 0 0 24px rgba(255,255,255,.22);
      opacity:.0;
      animation: starTwinkle var(--tw, 2.6s) ease-in-out infinite;
    }
    @keyframes starTwinkle{ 0%{opacity:.30} 50%{opacity:.98} 100%{opacity:.45} }

    #splash::after{
      content:"";
      position:absolute; inset:0;
      background-image:
        url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='160' height='160'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='160' height='160' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
      mix-blend-mode: overlay;
      opacity:.22;
      pointer-events:none;
    }
    #splash.fadeOut{ animation: splashFade .55s ease forwards; }
    @keyframes splashFade{ to{ opacity:0; transform: scale(1.02); } }

    .splashBox{ width:min(360px, 90vw); text-align:center; padding: 18px 16px 16px; position:relative; z-index:2; }
    .sLogo{
      width:96px;height:96px;border-radius:28px;
      margin:0 auto 14px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06);
      box-shadow: 0 18px 48px rgba(0,0,0,.45), 0 0 34px rgba(124,58,237,.22);
      overflow:hidden;
      display:grid;place-items:center;
      animation: logoPulse 2.4s ease-in-out infinite;
    }
    @keyframes logoPulse{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.03)} }
    .sLogo img{ width:100%;height:100%;object-fit:cover;display:block; }
    .sText{ font-weight:900; letter-spacing:.2px; margin:0 0 10px; color: rgba(241,241,255,.94); font-size:14px; }
    .sBar{
      height:14px;border-radius:999px;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      overflow:hidden;
      box-shadow: 0 16px 40px rgba(0,0,0,.25);
    }
    .sFill{
      height:100%; width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(55,55,62,.96), rgba(115,115,130,.86), rgba(255,255,255,.98));
      position:relative; overflow:hidden;
      animation: loadingFill var(--loadDur) linear forwards;
    }
    .sFill::after{
      content:"";
      position:absolute; inset:-40% -30%;
      background: radial-gradient(closest-side, rgba(255,255,255,.45), transparent 65%);
      transform: translateX(-40%) rotate(12deg);
      animation: sheen 1.1s ease-in-out infinite;
      opacity:.62;
    }
    @keyframes loadingFill{ to{ width:100%; } }
    @keyframes sheen{ 0%{transform:translateX(-40%) rotate(12deg)} 100%{transform:translateX(140%) rotate(12deg)} }
    .sHint{ margin-top:10px; font-size:12px; color: rgba(241,241,255,.76); min-height: 16px; }
  </style>
</head>

<body>
  <div id="dbg"></div>

  <!-- Splash -->
  <div id="splash" style="--loadDur: 6s;">
    <div id="starfield"></div>
    <div class="splashBox">
      <div class="sLogo">
        <img src="logo.png" alt="logo" onerror="this.style.display='none'; this.parentElement.textContent='üü£';" />
      </div>
      <p class="sText">Welcome to TonSecretShop</p>
      <div class="sBar"><div class="sFill"></div></div>
      <div class="sHint" id="sHint">Preparing experience‚Ä¶</div>
    </div>
  </div>

  <div class="wrap" id="app">
    <div class="top">
      <div class="brand">
        <div class="logo">
          <img src="logo.png" alt="Ton Secret Shop logo" onerror="this.style.display='none'; this.parentElement.textContent='üü£';" />
        </div>

        <div class="titleWrap">
          <p class="title">Ton Secret Shop</p>
          <div class="subRow">
            <p class="sub">order your future</p>
            <div class="hdrBtns">
              <button class="iconBtn" id="profileBtn" title="Profile">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Z" stroke="white" opacity="0.95" stroke-width="1.7"/>
                  <path d="M20 20a8 8 0 0 0-16 0" stroke="white" opacity="0.95" stroke-width="1.7" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="services"><span>–£—Å–ª—É–≥–∏</span><span class="dot"></span></button>
      <button class="tab" data-tab="portfolio"><span>–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</span><span class="dot"></span></button>
      <button class="tab" data-tab="order"><span>–ó–∞–∫–∞–∑</span><span class="dot"></span></button>
    </div>

    <!-- SERVICES -->
    <section class="screen active" id="services">
      <div class="card">
        <div class="note">
          –í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç ‚Üí –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ ‚Üí ‚Äú–í –∫–æ—Ä–∑–∏–Ω—É‚Äù –∏–ª–∏ ‚Äú–ó–∞–∫–∞–∑–∞—Ç—å‚Äù.
        </div>
        <div class="foot">–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–∫–∞–∑–∞ –≤ –ª–∏—á–∫—É: @Rapgospod</div>
      </div>

      <div class="card" id="cartCard">
        <div class="cartHead">
          <h3>üõí –ö–æ—Ä–∑–∏–Ω–∞</h3>
          <span class="pill" id="cartCount">0 items</span>
        </div>
        <div class="cartList" id="cartList"></div>
        <div class="total">
          <span>Total:</span>
          <span id="cartTotal">$0.00</span>
        </div>
        <div class="mutedSmall" id="cartHint">–ü–æ–∫–∞ –ø—É—Å—Ç–æ.</div>
        <div class="row" style="margin-top:12px;">
          <button class="btn" id="orderFromCartBtn">–ó–∞–∫–∞–∑–∞—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã</button>
          <button class="btn secondary" id="clearCartBtn">–û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
      </div>

      <div class="grid">

        <!-- 1 -->
        <div class="card serviceCard" data-service="–°—Ç–∏–∫–µ—Ä—ã / Emoji">
          <div class="service">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M7 3h7a7 7 0 0 1 7 7v7a4 4 0 0 1-4 4H10a7 7 0 0 1-7-7V7a4 4 0 0 1 4-4Z" stroke="white" opacity="0.9" stroke-width="1.7"/>
                <path d="M14 3v5a4 4 0 0 0 4 4h5" stroke="white" opacity="0.9" stroke-width="1.7"/>
              </svg>
            </div>
            <div>
              <h3>‚≠êÔ∏è –°—Ç–∏–∫–µ—Ä—ã / Emoji</h3>
              <p>–°—Ç–∞—Ç–∏—á–Ω—ã–µ –∏ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ. –ü–æ–¥ Telegram.</p>

              <div class="thumb">
                <img src="stickersEmoj.png" alt="stickers"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
                <div class="ph">stickersEmoj.png</div>
              </div>

              <div class="priceTitle">–í–∞—Ä–∏–∞–Ω—Ç—ã:</div>
              <div class="options">
                <button class="opt active" data-opt="–°—Ç–∞—Ç–∏—á–Ω—ã–π —Å—Ç–∏–∫–µ—Ä ‚Äî $6.5">–°—Ç–∞—Ç. —Å—Ç–∏–∫–µ—Ä $6.5</button>
                <button class="opt" data-opt="–°—Ç–∞—Ç–∏—á–Ω—ã–π —ç–º–æ–¥–∑–∏ ‚Äî $7.5">–°—Ç–∞—Ç. —ç–º–æ–¥–∑–∏ $7.5</button>
                <button class="opt" data-opt="–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π tgs —Å—Ç–∏–∫–µ—Ä ‚Äî $49">TGS —Å—Ç–∏–∫–µ—Ä $49</button>
                <button class="opt" data-opt="–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —ç–º–æ–¥–∑–∏ ‚Äî $50">TGS —ç–º–æ–¥–∑–∏ $50</button>
              </div>

              <div class="row">
                <div class="qtyWrap">
                  <button class="qtyBtn" data-act="minus">‚àí</button>
                  <div class="qtyVal" data-qty>1</div>
                  <button class="qtyBtn" data-act="plus">+</button>
                </div>

                <button class="btn secondary" data-act="add">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn" data-act="order">–ó–∞–∫–∞–∑–∞—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 2 -->
        <div class="card serviceCard" data-service="–î–∏–∑–∞–π–Ω –ø—Ä–æ–µ–∫—Ç–∞">
          <div class="service">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M4 7.5A3.5 3.5 0 0 1 7.5 4h9A3.5 3.5 0 0 1 20 7.5v9A3.5 3.5 0 0 1 16.5 20h-9A3.5 3.5 0 0 1 4 16.5v-9Z" stroke="white" opacity="0.9" stroke-width="1.7"/>
              </svg>
            </div>
            <div>
              <h3>üå∏ –î–∏–∑–∞–π–Ω –ø—Ä–æ–µ–∫—Ç–∞</h3>
              <p>–ê–≤–∞—Ç–∞—Ä—ã, –æ–±–æ–∏, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ Telegram/—Å–æ—Ü—Å–µ—Ç–µ–π.</p>

              <div class="thumb">
                <img src="AvatarsLogo.png" alt="design"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
                <div class="ph">AvatarsLogo.png</div>
              </div>

              <div class="priceTitle">–í–∞—Ä–∏–∞–Ω—Ç—ã:</div>
              <div class="options">
                <button class="opt active" data-opt="–ó–∞–∫–∞–∑–Ω–æ–π –∞—Ä—Ç-–∞–≤–∞—Ç–∞—Ä ‚Äî $20">–ê—Ä—Ç-–∞–≤–∞—Ç–∞—Ä $20</button>
                <button class="opt" data-opt="–ê—Ä—Ç-–±–∞–Ω–Ω–µ—Ä –¥–ª—è –ø–æ—Å—Ç–∞ ‚Äî $18">–ê—Ä—Ç-–±–∞–Ω–Ω–µ—Ä $18</button>
                <button class="opt" data-opt="–®–∞–±–ª–æ–Ω–Ω—ã–π –∞–≤–∞—Ç–∞—Ä/–±–∞–Ω–Ω–µ—Ä (Photoshop) ‚Äî $10">–®–∞–±–ª–æ–Ω $10</button>
              </div>

              <div class="row">
                <div class="qtyWrap">
                  <button class="qtyBtn" data-act="minus">‚àí</button>
                  <div class="qtyVal" data-qty>1</div>
                  <button class="qtyBtn" data-act="plus">+</button>
                </div>

                <button class="btn secondary" data-act="add">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn" data-act="order">–ó–∞–∫–∞–∑–∞—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 3 -->
        <div class="card serviceCard" data-service="–ê–Ω–∏–º–∞—Ü–∏—è">
          <div class="service">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M5 6.5A2.5 2.5 0 0 1 7.5 4h9A2.5 2.5 0 0 1 19 6.5v11A2.5 2.5 0 0 1 16.5 20h-9A2.5 2.5 0 0 1 5 17.5v-11Z" stroke="white" opacity="0.9" stroke-width="1.7"/>
                <path d="M11 9l5 3-5 3V9Z" fill="white" opacity="0.9"/>
              </svg>
            </div>
            <div>
              <h3>üé¨ –ê–Ω–∏–º–∞—Ü–∏—è</h3>
              <p>–õ—É–ø—ã, –∏–Ω—Ç—Ä–æ, –ø—Ä–æ–º–æ –ø–æ–¥ Telegram/—Å–æ—Ü—Å–µ—Ç–∏.</p>

              <div class="thumb">
                <img src="animations.png" alt="motion"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
                <div class="ph">animations.png</div>
              </div>

              <div class="priceTitle">–í–∞—Ä–∏–∞–Ω—Ç—ã:</div>
              <div class="options">
                <button class="opt active" data-opt="–ê—Ä—Ç —Ä–æ–ª–∏–∫ 5 —Å–µ–∫—É–Ω–¥ ‚Äî $25">5s $25</button>
                <button class="opt" data-opt="–ê—Ä—Ç —Ä–æ–ª–∏–∫ 10 —Å–µ–∫—É–Ω–¥ ‚Äî $50">10s $50</button>
                <button class="opt" data-opt="–ê—Ä—Ç —Ä–æ–ª–∏–∫ 15 —Å–µ–∫—É–Ω–¥ ‚Äî $70">15s $70</button>
                <button class="opt" data-opt="–ê—Ä—Ç —Ä–æ–ª–∏–∫ 30 —Å–µ–∫—É–Ω–¥ ‚Äî $120">30s $120</button>
              </div>

              <div class="row">
                <div class="qtyWrap">
                  <button class="qtyBtn" data-act="minus">‚àí</button>
                  <div class="qtyVal" data-qty>1</div>
                  <button class="qtyBtn" data-act="plus">+</button>
                </div>

                <button class="btn secondary" data-act="add">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn" data-act="order">–ó–∞–∫–∞–∑–∞—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 4 -->
        <div class="card serviceCard" data-service="Web3 / NFT –¥–∏–∑–∞–π–Ω">
          <div class="service">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M12 3l8 5v8l-8 5-8-5V8l8-5Z" stroke="white" opacity="0.9" stroke-width="1.7"/>
              </svg>
            </div>
            <div>
              <h3>üíé Web3 / NFT –¥–∏–∑–∞–π–Ω</h3>
              <p>–ö–æ–ª–ª–µ–∫—Ü–∏–∏, –±–∞–Ω–Ω–µ—Ä—ã, –∫–∞—Ä—Ç–æ—á–∫–∏, –ø–æ—Å—Ç–µ—Ä—ã. –¶–µ–Ω–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ.</p>

              <div class="thumb">
                <img src="Web3NFT.png" alt="web3"
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
                <div class="ph">Web3NFT.png</div>
              </div>

              <div class="priceTitle">–í–∞—Ä–∏–∞–Ω—Ç—ã:</div>
              <div class="options">
                <button class="opt active" data-opt="–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ (TBD)">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ</button>
              </div>

              <div class="row">
                <div class="qtyWrap">
                  <button class="qtyBtn" data-act="minus">‚àí</button>
                  <div class="qtyVal" data-qty>1</div>
                  <button class="qtyBtn" data-act="plus">+</button>
                </div>

                <button class="btn secondary" data-act="add">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                <button class="btn" data-act="order">–ó–∞–∫–∞–∑–∞—Ç—å</button>
              </div>
            </div>
          </div>
        </div>

      </div>
    </section>

    <!-- PORTFOLIO -->
    <section class="screen" id="portfolio">
      <div class="card">
        <div class="note">–ü–ª–∏—Ç–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ. –ü–æ –∫–ª–∏–∫—É ‚Äî ‚Äú—ç–ø–∏–∑–æ–¥‚Äù workXepX.png –∏ –æ–ø–∏—Å–∞–Ω–∏–µ.</div>
      </div>

      <div class="card">
        <div class="portfolioGrid">
          <div class="work"
               data-title="Work #1"
               data-ep="work1ep1.png"
               data-desc="–°—Ç–∏–∫–µ—Ä–ø–∞–∫ –∫–∞–Ω–∞–ª—É: t.me/barboskich.ton
—Å—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∏–∫–µ—Ä–ø–∞–∫: t.me/addstickers/BarboskichtonBarboskichTon
–í —Å—Ç–∏–∫–µ—Ä–ø–∞–∫–µ 51 —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Å—Ç–∏–∫–µ—Ä, –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–≤—ã—Ö –æ–±—ä—ë–º–Ω—ã—Ö —Ä–∞–±–æ—Ç Tss
–í–ª–∞–¥–µ–ª–µ—Ü –∫–∞–Ω–∞–ª–∞: https://t.me/barboskich">
            <img src="work1.png" alt="work1" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work1.png</div>
            <div class="label">Work #1</div>
          </div>

          <div class="work" data-title="Work #2" data-ep="work2ep2.png" data-desc="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∑–∂–µ">
            <img src="work2.png" alt="work2" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work2.png</div>
            <div class="label">Work #2</div>
          </div>

          <div class="work" data-title="Work #3" data-ep="work3ep3.png" data-desc="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∑–∂–µ">
            <img src="work3.png" alt="work3" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work3.png</div>
            <div class="label">Work #3</div>
          </div>

          <div class="work" data-title="Work #4" data-ep="work4ep4.png" data-desc="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∑–∂–µ">
            <img src="work4.png" alt="work4" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work4.png</div>
            <div class="label">Work #4</div>
          </div>

          <div class="work" data-title="Work #5" data-ep="work5ep5.png" data-desc="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∑–∂–µ">
            <img src="work5.png" alt="work5" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work5.png</div>
            <div class="label">Work #5</div>
          </div>

          <div class="work" data-title="Work #6" data-ep="work6ep6.png" data-desc="–û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–∑–∂–µ">
            <img src="work6.png" alt="work6" onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph">work6.png</div>
            <div class="label">Work #6</div>
          </div>
        </div>
      </div>
    </section>

    <!-- ORDER -->
    <section class="screen" id="order">
      <div class="subTabs">
        <button class="subTab active" data-sub="orderMain">–ó–∞–∫–∞–∑</button>
        <button class="subTab" data-sub="tasks">–ó–∞–¥–∞–Ω–∏—è</button>
      </div>

      <div class="screen active" id="orderMain">
        <div class="card">
          <h3 style="margin:0 0 8px;font-size:14px;font-weight:900">–ö–∞–∫ –∑–∞–∫–∞–∑–∞—Ç—å</h3>
          <div class="note" style="margin-top:0">
            1) –î–æ–±–∞–≤—å —É—Å–ª—É–≥–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É<br/>
            2) –ù–∞–∂–º–∏ ‚Äú–ó–∞–∫–∞–∑–∞—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã‚Äù –∏–ª–∏ –æ—Ç–∫—Ä–æ–π —á–∞—Ç<br/>
            3) –ú—ã —É—Ç–æ—á–Ω–∏–º –¥–µ—Ç–∞–ª–∏ –∏ —Å—Ä–æ–∫–∏
          </div>

          <div class="row">
            <button class="btn" id="openChatBtn">–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç @Rapgospod</button>
            <button class="btn secondary" id="copyBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç</button>
          </div>
        </div>

        <div class="card">
          <div class="note" style="margin:0 0 10px">–ö–∞—Ä—Ç–∏–Ω–∫–∞ –±–ª–æ–∫–∞: <b>TSSs.png</b> —Ä—è–¥–æ–º —Å index.html</div>
          <div class="thumb">
            <img src="TSSs.png" alt="TSS"
                 onerror="this.style.display='none'; this.nextElementSibling.style.display='grid';" />
            <div class="ph" style="display:grid;">TSSs.png (placeholder)</div>
          </div>
        </div>
      </div>

      <div class="screen" id="tasks">
        <div class="card">
          <h3 style="margin:0 0 8px;font-size:14px;font-weight:900">–ó–∞–¥–∞–Ω–∏—è</h3>
          <div class="note">–ß–µ–∫-–∏–Ω ‚Äî —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—á–∏–π: 1 —Ä–∞–∑ –≤ –¥–µ–Ω—å, 5 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥ ‚Üí –±–æ–Ω—É—Å.</div>
        </div>

        <div class="card">
          <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:10px;">
            <div>
              <b style="display:block;font-size:13px;">1) –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ @TonSecretShop</b>
              <span style="display:block;font-size:12px;color:rgba(241,241,255,.70);margin-top:4px;">
                –û—Ç–∫—Ä–æ–µ–º –∫–∞–Ω–∞–ª ‚Äî –ø–æ–¥–ø–∏—à–∏—Å—å –∏ –≤–µ—Ä–Ω–∏—Å—å.
              </span>
            </div>
            <button class="miniBtn" id="openChannelBtn">Open</button>
          </div>
        </div>

        <div class="card">
          <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:10px;">
            <div style="flex:1;min-width:0;">
              <b style="display:block;font-size:13px;">2) –ß–µ–∫-–∏–Ω 5 –¥–Ω–µ–π –ø–æ–¥—Ä—è–¥</b>
              <span style="display:block;font-size:12px;color:rgba(241,241,255,.70);margin-top:4px;">
                –ü—Ä–æ–ø—É—Å—Ç–∏–ª –¥–µ–Ω—å ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–æ—Å–∏—Ç—Å—è.
              </span>

              <div class="progressWrap">
                <div class="progressFill" id="checkFill"></div>
              </div>
              <div class="mutedSmall" id="checkText">0/5</div>
              <div class="mutedSmall" id="checkStatus"></div>
            </div>
            <button class="miniBtn" id="checkBtn">Check-in</button>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Work modal -->
  <div class="backdrop" id="workBackdrop" aria-hidden="true">
    <div class="modal">
      <div class="modalHead">
        <h2 id="wTitle">Work</h2>
        <button class="x" id="wClose">√ó</button>
      </div>
      <div class="mImg">
        <img id="wImg" src="" alt="ep" onerror="this.style.display='none';" />
      </div>
      <p id="wDesc" style="white-space:pre-line;"></p>
    </div>
  </div>

  <!-- Profile modal -->
  <div class="backdrop" id="profileBackdrop" aria-hidden="true">
    <div class="modal">
      <div class="modalHead">
        <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
        <button class="x" id="pClose">√ó</button>
      </div>

      <div style="display:flex;gap:12px;align-items:center;">
        <div class="logo" style="width:54px;height:54px;border-radius:18px;">
          <div id="pAvatar" style="width:100%;height:100%;display:grid;place-items:center;font-weight:900;color:#fff;">?</div>
        </div>
        <div style="min-width:0;">
          <b id="pName" style="display:block;font-size:13px;">User</b>
          <span id="pUser" style="display:block;font-size:12px;color:rgba(241,241,255,.70);margin-top:4px;">@username</span>
          <span id="pFirst" style="display:block;font-size:11px;color:rgba(241,241,255,.55);margin-top:4px;">First visit: ‚Äî</span>
        </div>
      </div>

      <div class="bubble">–¢—É—Ç –º–æ–≥—É—Ç –±—ã—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥–º–µ—Ç—ã, —Å–∫–∏–¥–∫–∏, –ø–æ–∫—É–ø–∫–∏ –∏ –≤–∞—É—á–µ—Ä—ã.</div>

      <div class="invGrid">
        <div class="slot">Slot 1</div><div class="slot">Slot 2</div><div class="slot">Slot 3</div>
        <div class="slot">Slot 4</div><div class="slot">Slot 5</div><div class="slot">Slot 6</div>
      </div>

      <div style="margin-top:12px;">
        <b style="display:block;font-size:12px;">Daily check-in</b>
        <div class="progressWrap"><div class="progressFill" id="pCheckFill"></div></div>
        <div class="mutedSmall" id="pCheckText">0/5</div>
      </div>

      <div class="row" style="margin-top:12px;">
        <button class="btn secondary" id="goTasksBtn">–û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞–Ω–∏—è</button>
        <button class="btn" id="pCheckBtn">Check-in</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const dbg = document.getElementById("dbg");
      function showErr(msg){
        dbg.style.display = "block";
        dbg.textContent = "JS ERROR:\n" + msg;
      }
      window.addEventListener("error", (e)=> showErr(e.message + (e.lineno ? `\nline: ${e.lineno}` : "")));
      window.addEventListener("unhandledrejection", (e)=> showErr(String(e.reason || e)));

      // --- Telegram
      const tg = window.Telegram && window.Telegram.WebApp ? window.Telegram.WebApp : null;
      try{ tg && tg.expand(); }catch(_){}

      // --- constants
      const TARGET_USER = "Rapgospod";

      const LS_FIRST = "tss_first_visit";
      const LS_CART  = "tss_cart_v2";
      const LS_CK_LAST = "tss_checkin_last";
      const LS_CK_PROG = "tss_checkin_prog";

      const pad2 = (n)=> String(n).padStart(2,"0");
      const todayStr = ()=>{
        const d=new Date();
        return `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
      };
      const yesterdayStr = ()=>{
        const d=new Date(); d.setDate(d.getDate()-1);
        return `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
      };
      const dateToHuman = (s)=>{
        if(!s) return "‚Äî";
        const [y,m,d]=s.split("-");
        return `${d}.${m}.${y}`;
      };

      // --- first visit
      let firstVisit = localStorage.getItem(LS_FIRST);
      if(!firstVisit){ firstVisit = todayStr(); localStorage.setItem(LS_FIRST, firstVisit); }

      // --- splash: ALWAYS hide fallback
      const splash = document.getElementById("splash");
      const dur = (Math.floor(Math.random()*5)+4);
      splash.style.setProperty("--loadDur", dur+"s");
      const phrases = [
        "Loading‚Ä¶","–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶","–ü–æ–¥–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ‚Ä¶","–£–±–∏—Ä–∞–µ–º –ø—ã–ª—å‚Ä¶","–°—Ç–∏—Ä–∞–µ–º —Å –¥–æ—Å–∫–∏‚Ä¶",
        "–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ‚Ä¶","–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–º–Ω–∞—Ç—É‚Ä¶","–ü—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–µ–º –ø–æ–º–µ—â–µ–Ω–∏–µ‚Ä¶","–ü—Ä–æ—Ç–∏—Ä–∞–µ–º –æ–∫–Ω–æ‚Ä¶",
        "–í–∑–≤–µ—à–∏–≤–∞–µ–º –∫–æ—Ç–∞‚Ä¶","–°—Ç—Ä–æ–∏–º –∫–æ–º–Ω–∞—Ç—É‚Ä¶","–ó–∞—Ä—è–∂–∞–µ–º –Ω–µ–æ–Ω‚Ä¶","–ö–∞–ª–∏–±—Ä—É–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç—ã‚Ä¶",
        "–°—Ç–∞–≤–∏–º –≤—Å—ë –ø–æ –ø–∏–∫—Å–µ–ª—è–º‚Ä¶","–ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–∂–∏–º‚Ä¶"
      ];
      document.getElementById("sHint").textContent = phrases[Math.floor(Math.random()*phrases.length)];

      // stars (bright & many)
      const starWrap = document.getElementById("starfield");
      const starCount = 200;
      for(let i=0;i<starCount;i++){
        const s=document.createElement("span");
        s.className="star";
        const x=Math.random()*100, y=Math.random()*100;
        const big = Math.random()<0.16;
        const size = big ? (2.6 + Math.random()*2.0) : (1.3 + Math.random()*1.4);
        s.style.left=x+"%"; s.style.top=y+"%";
        s.style.width=size+"px"; s.style.height=size+"px";
        s.style.setProperty("--tw", (1.5+Math.random()*2.8).toFixed(2)+"s");
        starWrap.appendChild(s);
      }

      function hideSplash(){
        if(!splash || splash.dataset.hidden==="1") return;
        splash.dataset.hidden="1";
        splash.classList.add("fadeOut");
        setTimeout(()=>{ splash.style.display="none"; }, 650);
      }
      setTimeout(hideSplash, dur*1000);
      setTimeout(hideSplash, 9000); // hard fallback

      // --- tab system
      const screens = {
        services: document.getElementById("services"),
        portfolio: document.getElementById("portfolio"),
        order: document.getElementById("order")
      };
      document.querySelectorAll(".tab").forEach(btn=>{
        btn.addEventListener("click", ()=>{
          const name = btn.dataset.tab;
          document.querySelectorAll(".tab").forEach(x=>x.classList.toggle("active", x===btn));
          Object.keys(screens).forEach(k=>screens[k].classList.toggle("active", k===name));
          try{ tg && tg.HapticFeedback && tg.HapticFeedback.impactOccurred("light"); }catch(_){}
        });
      });

      // --- order sub tabs
      const subScreens = {
        orderMain: document.getElementById("orderMain"),
        tasks: document.getElementById("tasks")
      };
      function setSub(name){
        document.querySelectorAll(".subTab").forEach(b=>b.classList.toggle("active", b.dataset.sub===name));
        Object.keys(subScreens).forEach(k=>subScreens[k].classList.toggle("active", k===name));
      }
      document.querySelectorAll(".subTab").forEach(b=>b.addEventListener("click", ()=> setSub(b.dataset.sub)));

      // --- cart
      function safeParse(s, fallback){ try{return JSON.parse(s);}catch(_){return fallback;} }
      let cart = safeParse(localStorage.getItem(LS_CART), []);
      function saveCart(){ localStorage.setItem(LS_CART, JSON.stringify(cart)); }
      function parsePrice(optionText){
        const m = String(optionText||"").match(/\$([0-9]+(?:\.[0-9]+)?)/);
        return m ? Number(m[1]) : null;
      }
      function cartCount(){ return cart.reduce((a,it)=>a+(it.qty||0),0); }
      function cartTotal(){ return cart.reduce((a,it)=>a+((it.price??0)*it.qty),0); }
      function hasTBD(){ return cart.some(it=>it.price===null); }

      const cartList = document.getElementById("cartList");
      const cartTotalEl = document.getElementById("cartTotal");
      const cartCountEl = document.getElementById("cartCount");
      const cartHintEl = document.getElementById("cartHint");

      function renderCart(){
        cartCountEl.textContent = `${cartCount()} items`;
        cartList.innerHTML = "";
        if(cart.length===0){
          cartHintEl.textContent = "–ü–æ–∫–∞ –ø—É—Å—Ç–æ.";
        } else {
          cartHintEl.textContent = hasTBD() ? "–ï—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏ —Å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Ü–µ–Ω–æ–π (TBD)." : "–ì–æ—Ç–æ–≤–æ –∫ –∑–∞–∫–∞–∑—É.";
        }
        cart.forEach(it=>{
          const div=document.createElement("div");
          div.className="cartItem";
          const priceText = it.price===null ? "TBD" : `$${it.price}`;
          div.innerHTML = `
            <div style="min-width:0;">
              <b>${it.service} √ó ${it.qty}</b>
              <span>${it.option} ‚Ä¢ ${priceText}</span>
            </div>
            <button class="miniBtn danger" data-del="${it.key}">–£–¥–∞–ª–∏—Ç—å</button>
          `;
          cartList.appendChild(div);
        });
        cartTotalEl.textContent = `$${cartTotal().toFixed(2)}`;
        cartList.querySelectorAll("[data-del]").forEach(btn=>{
          btn.addEventListener("click", ()=>{
            cart = cart.filter(x=>x.key!==btn.dataset.del);
            saveCart(); renderCart();
          });
        });
      }
      renderCart();

      document.getElementById("clearCartBtn").addEventListener("click", ()=>{
        cart=[]; saveCart(); renderCart();
      });

      function addToCart(service, option, qty){
        const price = parsePrice(option);
        const key = service + "||" + option;
        const idx = cart.findIndex(x=>x.key===key);
        if(idx>=0) cart[idx].qty += qty;
        else cart.push({key, service, option, qty, price});
        saveCart(); renderCart();
      }

      // --- build message
      const u = tg && tg.initDataUnsafe ? tg.initDataUnsafe.user : null;
      const firstName = (u && u.first_name) ? u.first_name : "User";
      const userName = (u && u.username) ? ("@" + u.username) : "";

      function buildOrderText(items){
        const header = [
          "üõí Ton Secret Shop ‚Äî new order",
          `User: ${firstName}${userName ? " "+userName : ""}`,
          `First visit: ${dateToHuman(firstVisit)}`
        ];
        const lines = ["", "Items:"];
        items.forEach((it, idx)=>{
          const price = (it.price===null || it.price===undefined) ? "TBD" : `$${it.price}`;
          lines.push(`${idx+1}) ${it.service} √ó ${it.qty} ‚Äî ${it.option} (${price})`);
        });
        const total = items.reduce((a,it)=>a+((it.price??0)*it.qty),0);
        lines.push("");
        lines.push(`Total (known): $${total.toFixed(2)}`);
        if(items.some(it=>it.price===null)) lines.push("Note: Some items have –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ (TBD).");
        lines.push("");
        lines.push("Deadline: ");
        lines.push("Budget: ");
        return header.concat(lines).join("\n");
      }

      function openChat(text){
        const url = "https://t.me/" + TARGET_USER + "?text=" + encodeURIComponent(text);
        try{
          if(tg && tg.openTelegramLink) tg.openTelegramLink(url);
          else window.location.href = url;
        }catch(_){ window.location.href = url; }
      }

      document.getElementById("orderFromCartBtn").addEventListener("click", ()=>{
        if(cart.length===0){ alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞—è üôÇ"); return; }
        openChat(buildOrderText(cart));
      });
      document.getElementById("openChatBtn").addEventListener("click", ()=>{
        openChat(buildOrderText(cart.length?cart:[{service:"‚Ä¶",option:"‚Ä¶",qty:1,price:null}]));
      });
      document.getElementById("copyBtn").addEventListener("click", async ()=>{
        const t = buildOrderText(cart.length?cart:[{service:"‚Ä¶",option:"‚Ä¶",qty:1,price:null}]);
        try{ await navigator.clipboard.writeText(t); alert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úÖ"); }
        catch(_){ alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –°–∫–æ–ø–∏—Ä—É–π –≤—Ä—É—á–Ω—É—é:\n\n"+t); }
      });

      // --- Service cards (event delegation ‚Äî –∫—Ä–µ–ø—á–µ)
      function clamp(v,a,b){ return Math.max(a, Math.min(b,v)); }

      document.querySelectorAll(".serviceCard").forEach(card=>{
        // option buttons
        card.querySelectorAll(".opt").forEach(opt=>{
          opt.addEventListener("click", ()=>{
            card.querySelectorAll(".opt").forEach(o=>o.classList.remove("active"));
            opt.classList.add("active");
          });
        });

        card.addEventListener("click", (e)=>{
          const actBtn = e.target.closest("[data-act]");
          if(!actBtn) return;
          const act = actBtn.dataset.act;
          const qtyEl = card.querySelector("[data-qty]");
          let qty = Number(qtyEl.textContent || "1");
          if(act==="minus"){ qtyEl.textContent = String(clamp(qty-1,1,99)); return; }
          if(act==="plus"){ qtyEl.textContent = String(clamp(qty+1,1,99)); return; }

          const service = card.dataset.service;
          const opt = card.querySelector(".opt.active");
          const option = opt ? opt.dataset.opt : "Custom";
          qty = Number(qtyEl.textContent || "1");

          if(act==="add"){
            addToCart(service, option, qty);
            try{ tg && tg.HapticFeedback && tg.HapticFeedback.impactOccurred("light"); }catch(_){}
            return;
          }
          if(act==="order"){
            const item = { service, option, qty, price: parsePrice(option) };
            openChat(buildOrderText([item]));
            return;
          }
        });
      });

      // --- Portfolio modal
      const workBackdrop = document.getElementById("workBackdrop");
      const wTitle = document.getElementById("wTitle");
      const wImg = document.getElementById("wImg");
      const wDesc = document.getElementById("wDesc");
      function openWork(tile){
        wTitle.textContent = tile.dataset.title || "Work";
        wDesc.textContent = tile.dataset.desc || "";
        const ep = tile.dataset.ep || "";
        wImg.style.display = ep ? "block" : "none";
        wImg.src = ep;
        workBackdrop.classList.add("show");
        document.getElementById("app").classList.add("modalOpen");
      }
      function closeWork(){
        workBackdrop.classList.remove("show");
        document.getElementById("app").classList.remove("modalOpen");
      }
      document.getElementById("wClose").addEventListener("click", closeWork);
      workBackdrop.addEventListener("click", (e)=>{ if(e.target===workBackdrop) closeWork(); });

      document.querySelectorAll(".work").forEach(tile=>{
        tile.addEventListener("click", ()=> openWork(tile));
      });

      // --- Check-in (real)
      function loadCheck(){
        return {
          last: localStorage.getItem(LS_CK_LAST) || "",
          prog: Number(localStorage.getItem(LS_CK_PROG) || "0") // 0..4 (after complete resets)
        };
      }
      function saveCheck(last, prog){
        localStorage.setItem(LS_CK_LAST, last);
        localStorage.setItem(LS_CK_PROG, String(prog));
      }
      function normalizeCheck(){
        const st = loadCheck();
        if(!st.last) return st;
        const t = todayStr();
        const y = yesterdayStr();
        if(st.last===t || st.last===y) return st;
        saveCheck("", 0);
        return { last:"", prog:0 };
      }
      function doCheck(){
        let st = normalizeCheck();
        const t = todayStr();
        const y = yesterdayStr();

        if(st.last===t) return { ok:false, msg:"–£–∂–µ –æ—Ç–º–µ—á–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è ‚úÖ" };

        let next = 1;
        if(st.last===y) next = st.prog + 1;

        if(next>=5){
          // completed -> reset cycle (store last=today to prevent re-check same day)
          saveCheck(t, 0);
          return { ok:true, done:true, msg:"5/5 ‚úÖ –ë–æ–Ω—É—Å –ø–æ–ª—É—á–µ–Ω! –¶–∏–∫–ª –Ω–∞—á–∞–ª—Å—è –∑–∞–Ω–æ–≤–æ." };
        }else{
          saveCheck(t, next);
          return { ok:true, done:false, msg:`–ß–µ–∫-–∏–Ω –ø—Ä–∏–Ω—è—Ç ‚úÖ ${next}/5` };
        }
      }
      const checkFill = document.getElementById("checkFill");
      const checkText = document.getElementById("checkText");
      const checkStatus = document.getElementById("checkStatus");
      const pCheckFill = document.getElementById("pCheckFill");
      const pCheckText = document.getElementById("pCheckText");

      function renderCheck(){
        const st = normalizeCheck();
        const t = todayStr();
        const pct = (st.prog/5)*100;
        checkFill.style.width = pct + "%";
        checkText.textContent = `${st.prog}/5`;
        pCheckFill.style.width = pct + "%";
        pCheckText.textContent = `${st.prog}/5`;
        checkStatus.textContent = (st.last===t) ? "–°–µ–≥–æ–¥–Ω—è —É–∂–µ –æ—Ç–º–µ—á–µ–Ω–æ ‚úÖ" : "–ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —á–µ–∫-–∏–Ω —Å–µ–≥–æ–¥–Ω—è.";
      }
      renderCheck();

      document.getElementById("checkBtn").addEventListener("click", ()=>{
        const r = doCheck();
        renderCheck();
        alert(r.msg);
      });

      // --- Tasks: open channel
      document.getElementById("openChannelBtn").addEventListener("click", ()=>{
        const url = "https://t.me/TonSecretShop";
        try{ if(tg && tg.openTelegramLink) tg.openTelegramLink(url); else window.location.href = url; }
        catch(_){ window.location.href = url; }
      });

      // --- Profile modal
      const profileBackdrop = document.getElementById("profileBackdrop");
      const pAvatar = document.getElementById("pAvatar");
      const pName = document.getElementById("pName");
      const pUser = document.getElementById("pUser");
      const pFirst = document.getElementById("pFirst");
      const initials = (firstName || "U").slice(0,1).toUpperCase();

      function openProfile(){
        pAvatar.textContent = initials;
        pName.textContent = firstName;
        pUser.textContent = userName || "Telegram user";
        pFirst.textContent = "First visit: " + dateToHuman(firstVisit);
        profileBackdrop.classList.add("show");
        document.getElementById("app").classList.add("modalOpen");
        renderCheck();
      }
      function closeProfile(){
        profileBackdrop.classList.remove("show");
        document.getElementById("app").classList.remove("modalOpen");
      }
      document.getElementById("profileBtn").addEventListener("click", openProfile);
      document.getElementById("pClose").addEventListener("click", closeProfile);
      profileBackdrop.addEventListener("click", (e)=>{ if(e.target===profileBackdrop) closeProfile(); });

      document.getElementById("pCheckBtn").addEventListener("click", ()=>{
        const r = doCheck();
        renderCheck();
        alert(r.msg);
      });
      document.getElementById("goTasksBtn").addEventListener("click", ()=>{
        closeProfile();
        // go to order/tasks
        document.querySelectorAll(".tab").forEach(t=>t.classList.toggle("active", t.dataset.tab==="order"));
        Object.keys(screens).forEach(k=>screens[k].classList.toggle("active", k==="order"));
        setSub("tasks");
      });

    })();
  </script>
</body>
</html>